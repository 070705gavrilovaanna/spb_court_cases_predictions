# Прогнозирование исхода судебных дел в Арбитражном суде СПб

Проект по предсказанию результатов арбитражных дел Санкт-Петербурга на основе данных за 2023 год. Используя мультиклассовую классификацию, я построила модель, предсказывающую исход дела с точностью 59%.

**Ссылка на проект:** [court_cases_prediction.ipynb](https://colab.research.google.com/drive/18BRTg7_6QPKt9UwMvlJEeqsjgFKAYeeR#scrollTo=sYZRnGeJ4Zq3)

---

## Этапы работы

**Технологии:** Python, Pandas, Scikit-learn, XGBoost, LightGBM, Matplotlib


1. **Сбор данных:** Для сбора данных была проведена работа с официальной Картотекой арбитражных дел (kad.arbitr.ru) - государственным порталом, который содержит полную информацию о судебных процессах. Были отобраны вручную дела Арбитражного суда Санкт-Петербурга и Ленинградской области за 2023 год, просмотрены карточки дел и выгружена ключевая информация (участники, судья, сумма иска, категория и результат) для формирования собственного набора данных.

2. **Подготовка данных:** Работа с датасетом из 367 арбитражных дел 2023 года. Целевая переменная - результат дела:
   - `-1` - отказано в принятии иска (перекодировано в 0)
   - `0` - истцу отказано (осталось 0)
   - `1` - иск удовлетворен частично (перекодировано в 1)
   - `2` - иск удовлетворен полностью (перекодировано в 2)

3. **Feature Engineering:** Создала 18 юридически осмысленных признаков:
   - **Типы сторон:** автоматическая классификация истцов/ответчиков (госорганы, частные компании, ИП)
   - **Финансовые признаки:** логарифм суммы иска, категории сумм, дела с нулевыми исками
   - **Временные признаки:** длительность процесса, месяц подачи, квартал
   - **Специфические признаки:** дела против госорганов, банкротства, сложные категории дел

4. **Моделирование:** Сравнила 4 алгоритма:
   - RandomForest (лучший результат)
   - XGBoost
   - LightGBM
   - LogisticRegression

5. **Результаты (RandomForest):**
   - **Точность (accuracy):** 59%
   - **Precision для класса 2:** 0.74
   - **Recall для класса 2:** 0.63
   - **F1-score для класса 2:** 0.68
   - **Важнейший признак:** `is_bankruptcy` (дела о банкротстве)

---

## Оптимизация

1. **Балансировка классов:** Использовала class_weight='balanced' для работы с дисбалансом классов.
2. **GridSearchCV:** Подобрала оптимальные гиперпараметры для RandomForest.
3. **One-Hot Encoding:** Применила к категориальным признакам (категории дел, типы сторон).
4. **Логарифмирование:** Преобразовала суммы исков для нормализации распределения.
5. **Стратификация:** Сохранила распределение классов при разделении на train/test.

---


## Что я узнала

1. **Работа с мультиклассовой классификацией:** Задача с 3 классами (после перекодировки) требует аккуратной интерпретации метрик.
2. **Ограниченность данных:** Всего 367 дел - небольшой объем для обучения, что объясняет умеренную точность модели.
3. **Интерпретируемость в юридической области:** Анализ важности признаков показал, что **дела о банкротстве** имеют самое сильное влияние на результат, но не являются единственным значимым фактором. Также важны тип сторон процесса и сумма иска.

---

## Интерпретация результатов
- Модель показала точность 59%, что отражает высокую сложность задачи прогнозирования судебных решений.
- Лучше всего предсказываются дела с полным удовлетворением иска (F1=0.68).
- Наибольшую сложность представляют случаи частичного удовлетворения (F1=0.45) — самый редкий и субъективный исход.
- Несмотря на умеренную точность, анализ feature importance выявил реальные закономерности: дела о банкротстве, тип сторон и сумма иска статистически значимо влияют на исход.


**Ключевой вывод:** Прогнозирование судебных решений это сложная задача даже для современных алгоритмов МО. Точность 59% показывает, что модель улавливает некоторые закономерности, но полностью предсказать исход дела сложно из-за человеческого фактора и уникальности каждого случая. Однако созданные признаки (типы сторон, финансовые характеристики, категории дел) действительно влияют на исход процесса.
